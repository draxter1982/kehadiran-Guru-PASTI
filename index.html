<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Kehadiran Guru PASTI</title>
    
    <!-- 1. TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. REACT & REACT DOM -->
    <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js" crossorigin></script>
    
    <!-- 3. DEPENDENCIES UTK RECHARTS (PENTING) -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>

    <!-- 4. RECHARTS (Guna CDNJS yang lebih stabil untuk UMD) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.12.0/Recharts.min.js"></script>

    <!-- 5. BABEL -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 6. PHOSPHOR ICONS -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        .animate-fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
        .print-only { display: none; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

    <div id="root"></div>

    <script type="text/babel">
        // Semak jika React wujud
        if (!window.React || !window.ReactDOM) {
            document.getElementById('root').innerHTML = '<div class="p-4 text-red-600 font-bold">Ralat: React gagal dimuatkan. Sila refresh.</div>';
        }

        const { useState, useEffect } = React;
        
        // --- SAFE RECHARTS ACCESS ---
        // Kita ambil objek dari window.Recharts. Jika tiada, guna objek kosong untuk elak crash.
        const RechartsObj = window.Recharts || {};
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, Cell } = RechartsObj;

        // --- MOCK DATA ---
        const initialTeachers = [
            { id: 'G01', name: 'Cikgu Aishah', status: 'Hadir', timeIn: '07:30', timeOut: '13:00', reason: '' },
            { id: 'G02', name: 'Cikgu Fatimah', status: 'Hadir', timeIn: '07:45', timeOut: '--:--', reason: '' },
            { id: 'G03', name: 'Cikgu Rahman', status: 'Cuti', timeIn: '--:--', timeOut: '--:--', reason: 'Demam panas' },
            { id: 'G04', name: 'Cikgu Zulkifli', status: 'Tidak Hadir', timeIn: '--:--', timeOut: '--:--', reason: '' },
            { id: 'G05', name: 'Cikgu Hawa', status: 'Tugas Luar', timeIn: '08:00', timeOut: '--:--', reason: 'Mesyuarat Kawasan' },
        ];

        const mockYearlyData = [
            { name: 'Jan', hadir: 95, cuti: 2, tidakHadir: 3 },
            { name: 'Feb', hadir: 92, cuti: 5, tidakHadir: 3 },
            { name: 'Mac', hadir: 98, cuti: 1, tidakHadir: 1 },
            { name: 'Apr', hadir: 85, cuti: 10, tidakHadir: 5 },
            { name: 'Mei', hadir: 90, cuti: 5, tidakHadir: 5 },
            { name: 'Jun', hadir: 88, cuti: 8, tidakHadir: 4 },
            { name: 'Jul', hadir: 96, cuti: 2, tidakHadir: 2 },
            { name: 'Ogo', hadir: 93, cuti: 4, tidakHadir: 3 },
            { name: 'Sep', hadir: 95, cuti: 3, tidakHadir: 2 },
            { name: 'Okt', hadir: 91, cuti: 6, tidakHadir: 3 },
            { name: 'Nov', hadir: 97, cuti: 2, tidakHadir: 1 },
            { name: 'Dis', hadir: 80, cuti: 15, tidakHadir: 5 },
        ];

        const mockMonthlyPerformance = [
            { name: 'Cikgu Aishah', peratus: 98, lewat: 0, grade: 'A' },
            { name: 'Cikgu Fatimah', peratus: 95, lewat: 2, grade: 'A-' },
            { name: 'Cikgu Rahman', peratus: 85, lewat: 5, grade: 'B' },
            { name: 'Cikgu Zulkifli', peratus: 90, lewat: 3, grade: 'B+' },
            { name: 'Cikgu Hawa', peratus: 100, lewat: 0, grade: 'A+' },
        ];

        function App() {
            const [view, setView] = useState('dashboard');
            const [teachers, setTeachers] = useState(initialTeachers);
            const [isAdmin, setIsAdmin] = useState(false);
            const [passwordInput, setPasswordInput] = useState('');
            const [adminTab, setAdminTab] = useState('overview');
            const [scanMode, setScanMode] = useState(null); 
            const [selectedTeacherId, setSelectedTeacherId] = useState('');
            const [leaveReason, setLeaveReason] = useState('');
            const [scanMessage, setScanMessage] = useState('');
            const [isPrinting, setIsPrinting] = useState(false);

            // Periksa jika Recharts berjaya dimuatkan
            const isRechartsLoaded = !!window.Recharts;

            const getChartData = () => {
                const stats = { Hadir: 0, 'Dalam Proses': 0, Cuti: 0, 'Tugas Luar': 0, 'Tidak Hadir': 0 };
                teachers.forEach(t => {
                    if (t.status === 'Hadir' && t.timeOut !== '--:--') stats['Hadir']++;
                    else if (t.status === 'Hadir' && t.timeOut === '--:--') stats['Dalam Proses']++;
                    else if (t.status === 'Cuti') stats['Cuti']++;
                    else if (t.status === 'Tugas Luar') stats['Tugas Luar']++;
                    else stats['Tidak Hadir']++;
                });
                return [
                    { name: 'Selesai', jumlah: stats['Hadir'], fill: '#22c55e' },
                    { name: 'Bertugas', jumlah: stats['Dalam Proses'], fill: '#3b82f6' },
                    { name: 'T. Luar', jumlah: stats['Tugas Luar'], fill: '#8b5cf6' },
                    { name: 'Cuti', jumlah: stats['Cuti'], fill: '#eab308' },
                    { name: 'Tiada', jumlah: stats['Tidak Hadir'], fill: '#ef4444' },
                ];
            };

            const handleAttendanceSubmit = () => {
                if (!selectedTeacherId) return;
                const now = new Date();
                const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;

                setTeachers(prev => prev.map(t => {
                    if (t.id === selectedTeacherId) {
                        if (scanMode === 'clock_in') return { ...t, status: 'Hadir', timeIn: timeString, timeOut: '--:--', reason: '' };
                        else if (scanMode === 'clock_out') return { ...t, timeOut: timeString };
                        else if (scanMode === 'leave') return { ...t, status: 'Cuti', reason: leaveReason, timeIn: '--:--', timeOut: '--:--' };
                        else if (scanMode === 'outstation') return { ...t, status: 'Tugas Luar', reason: leaveReason, timeIn: timeString, timeOut: '--:--' };
                    }
                    return t;
                }));

                setScanMessage(`Berjaya direkodkan pada ${timeString}`);
                setTimeout(() => {
                    setScanMessage('');
                    setLeaveReason('');
                    setSelectedTeacherId('');
                    setView('dashboard');
                }, 2000);
            };

            const handlePrint = () => {
                setIsPrinting(true);
                setTimeout(() => { window.print(); setIsPrinting(false); }, 500);
            };

            const handleLogin = () => {
                if (passwordInput === 'admin123') { setIsAdmin(true); setPasswordInput(''); } 
                else { alert('Kata laluan salah!'); }
            };
            
            // Header Component
            const Header = () => (
                <div className="bg-green-600 text-white p-4 shadow-md flex justify-between items-center sticky top-0 z-50 no-print">
                    <div className="flex items-center gap-2">
                        <i className="ph ph-user-check text-3xl"></i>
                        <div>
                            <h1 className="text-xl font-bold leading-none">Sistem Guru PASTI</h1>
                            <p className="text-xs text-green-100 opacity-90">Rekod Kehadiran Pintar</p>
                        </div>
                    </div>
                    <div className="flex gap-2">
                        <button onClick={() => setView('dashboard')} className={`px-3 py-1 rounded text-sm font-bold ${view === 'dashboard' ? 'bg-white text-green-700' : 'bg-green-700'}`}>Utama</button>
                        <button onClick={() => setView('scan')} className={`px-3 py-1 rounded text-sm font-bold ${view === 'scan' ? 'bg-white text-green-700' : 'bg-green-700'}`}>Scan QR</button>
                        <button onClick={() => setView('admin')} className={`px-3 py-1 rounded text-sm font-bold ${view === 'admin' ? 'bg-white text-green-700' : 'bg-green-700'}`}>{isAdmin ? 'Admin' : 'Login'}</button>
                    </div>
                </div>
            );

            // Dashboard Component
            const DashboardView = () => {
                const data = getChartData();
                const today = new Date();
                const dateString = today.toLocaleDateString('ms-MY', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

                return (
                    <div className="p-4 space-y-6 max-w-4xl mx-auto animate-fade-in no-print">
                        <div className="grid grid-cols-2 md:grid-cols-5 gap-3">
                            {data.map((item, idx) => (
                                <div key={idx} className="bg-white p-3 rounded-lg shadow border-l-4" style={{ borderLeftColor: item.fill }}>
                                    <p className="text-gray-500 text-xs font-semibold uppercase">{item.name}</p>
                                    <p className="text-2xl font-bold text-gray-800">{item.jumlah}</p>
                                </div>
                            ))}
                        </div>

                        <div className="bg-white p-4 rounded-lg shadow">
                            <div className="flex flex-col md:flex-row justify-between items-center mb-4 gap-2">
                                <h3 className="text-lg font-bold text-gray-700 flex items-center gap-2">
                                    <i className="ph ph-chart-bar text-xl"></i> Statistik Harian
                                </h3>
                                <div className="flex items-center gap-2 text-sm font-medium text-gray-600 bg-gray-100 px-3 py-1.5 rounded-full border">
                                    <i className="ph ph-calendar text-green-600"></i> <span>{dateString}</span>
                                </div>
                            </div>
                            <div className="h-64 w-full flex items-center justify-center bg-gray-50 rounded">
                                {isRechartsLoaded ? (
                                    <ResponsiveContainer width="100%" height="100%">
                                        <BarChart data={data} layout="vertical" margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>
                                            <CartesianGrid strokeDasharray="3 3" horizontal={true} vertical={false} />
                                            <XAxis type="number" hide />
                                            <YAxis dataKey="name" type="category" width={80} tick={{fontSize: 12}} />
                                            <Tooltip cursor={{fill: 'transparent'}} />
                                            <Bar dataKey="jumlah" radius={[0, 4, 4, 0]} barSize={30}>
                                                {data.map((entry, index) => <Cell key={`cell-${index}`} fill={entry.fill} />)}
                                            </Bar>
                                        </BarChart>
                                    </ResponsiveContainer>
                                ) : (
                                    <div className="text-gray-500 text-sm">Graf sedang dimuatkan atau gagal dimuatkan...</div>
                                )}
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow overflow-hidden">
                            <div className="bg-gray-50 px-4 py-3 border-b flex justify-between items-center">
                                <h3 className="font-bold text-gray-700">Senarai Kehadiran Penuh</h3>
                                <div className="text-xs text-gray-400 italic">Dikemaskini serta-merta</div>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="w-full text-sm text-left">
                                    <thead className="text-xs text-gray-700 uppercase bg-gray-100">
                                        <tr>
                                            <th className="px-4 py-3">Nama Guru</th>
                                            <th className="px-4 py-3">Masuk</th>
                                            <th className="px-4 py-3">Balik</th>
                                            <th className="px-4 py-3">Status</th>
                                            <th className="px-4 py-3">Catatan</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {teachers.map((t, idx) => {
                                            let statusColor = "bg-white", badgeColor = "bg-gray-100 text-gray-800";
                                            if (t.status === 'Tidak Hadir') { statusColor = "bg-red-50"; badgeColor = "bg-red-100 text-red-800"; }
                                            else if (t.status === 'Cuti') badgeColor = "bg-yellow-100 text-yellow-800";
                                            else if (t.status === 'Hadir') badgeColor = "bg-green-100 text-green-800";
                                            else if (t.status === 'Tugas Luar') badgeColor = "bg-purple-100 text-purple-800";

                                            return (
                                                <tr key={idx} className={`border-b ${statusColor}`}>
                                                    <td className="px-4 py-3 font-medium">{t.name}</td>
                                                    <td className="px-4 py-3 font-mono text-gray-600">{t.timeIn}</td>
                                                    <td className="px-4 py-3 font-mono text-gray-600">{t.timeOut}</td>
                                                    <td className="px-4 py-3"><span className={`px-2 py-1 rounded text-xs font-semibold ${badgeColor}`}>{t.status}</span></td>
                                                    <td className="px-4 py-3 text-gray-500 italic truncate max-w-xs">{t.reason || '-'}</td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            };

            const ScanView = () => (
                <div className="p-4 md:p-8 max-w-6xl mx-auto">
                    <div className={`bg-white rounded-xl shadow-lg p-6 md:p-10 text-center space-y-8 no-print ${isPrinting ? 'hidden' : ''}`}>
                        {!scanMode ? (
                            <>
                                <div className="flex flex-col md:flex-row justify-between items-center gap-4 border-b pb-6">
                                    <div className="text-left">
                                        <h2 className="text-3xl font-bold text-gray-800">Sila Imbas QR</h2>
                                        <p className="text-gray-500">Pilih kod QR yang sesuai untuk aktiviti anda</p>
                                    </div>
                                    <button onClick={handlePrint} className="flex items-center gap-2 bg-gray-800 text-white px-5 py-3 rounded-lg shadow hover:bg-gray-900 transition-all">
                                        <i className="ph ph-printer text-xl"></i> Cetak Kod QR
                                    </button>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4">
                                    <div onClick={() => setScanMode('clock_in')} className="cursor-pointer bg-white border-2 border-blue-100 rounded-2xl p-6 hover:shadow-2xl hover:border-blue-500 transition-all">
                                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=PASTI_CLOCK_IN&color=1d4ed8" className="w-28 h-28 mx-auto mb-4" />
                                        <h3 className="text-xl font-bold text-blue-900 mb-2">QR MASUK</h3>
                                        <div className="flex items-center justify-center gap-2 text-blue-600 bg-blue-50 px-3 py-1 rounded-full text-sm font-semibold"><i className="ph ph-sign-in"></i> Datang</div>
                                    </div>
                                    <div onClick={() => setScanMode('clock_out')} className="cursor-pointer bg-white border-2 border-rose-100 rounded-2xl p-6 hover:shadow-2xl hover:border-rose-500 transition-all">
                                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=PASTI_CLOCK_OUT&color=be123c" className="w-28 h-28 mx-auto mb-4" />
                                        <h3 className="text-xl font-bold text-rose-900 mb-2">QR BALIK</h3>
                                        <div className="flex items-center justify-center gap-2 text-rose-600 bg-rose-50 px-3 py-1 rounded-full text-sm font-semibold"><i className="ph ph-sign-out"></i> Pulang</div>
                                    </div>
                                    <div onClick={() => setScanMode('outstation')} className="cursor-pointer bg-white border-2 border-purple-100 rounded-2xl p-6 hover:shadow-2xl hover:border-purple-500 transition-all">
                                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=PASTI_OUTSTATION&color=7e22ce" className="w-28 h-28 mx-auto mb-4" />
                                        <h3 className="text-xl font-bold text-purple-900 mb-2">TUGAS LUAR</h3>
                                        <div className="flex items-center justify-center gap-2 text-purple-600 bg-purple-50 px-3 py-1 rounded-full text-sm font-semibold"><i className="ph ph-briefcase"></i> Kursus</div>
                                    </div>
                                    <div onClick={() => setScanMode('leave')} className="cursor-pointer bg-white border-2 border-orange-100 rounded-2xl p-6 hover:shadow-2xl hover:border-orange-500 transition-all">
                                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=PASTI_LEAVE&color=c2410c" className="w-28 h-28 mx-auto mb-4" />
                                        <h3 className="text-xl font-bold text-orange-900 mb-2">CUTI / MC</h3>
                                        <div className="flex items-center justify-center gap-2 text-orange-600 bg-orange-50 px-3 py-1 rounded-full text-sm font-semibold"><i className="ph ph-calendar-x"></i> Cuti</div>
                                    </div>
                                </div>
                            </>
                        ) : (
                            <div className="max-w-md mx-auto text-left animate-fade-in py-8">
                                <div className="flex items-center gap-3 mb-6 pb-4 border-b">
                                    <div className="p-3 bg-gray-100 rounded-full"><i className="ph ph-scan text-2xl text-gray-600"></i></div>
                                    <div>
                                        <h3 className="font-bold text-xl text-gray-800">Mod Imbasan Aktif</h3>
                                        <button onClick={() => { setScanMode(null); setScanMessage(''); }} className="text-sm text-gray-500 underline">Kembali</button>
                                    </div>
                                </div>
                                <div className="space-y-4 bg-gray-50 p-6 rounded-lg border border-gray-200">
                                    <label className="block text-sm font-bold text-gray-700">Simulasi: Pilih ID Guru</label>
                                    <select className="w-full p-3 border rounded-lg bg-white" value={selectedTeacherId} onChange={(e) => setSelectedTeacherId(e.target.value)}>
                                        <option value="">-- Sila Scan/Pilih ID --</option>
                                        {teachers.map(t => <option key={t.id} value={t.id}>{t.name} ({t.id})</option>)}
                                    </select>
                                    {(scanMode === 'leave' || scanMode === 'outstation') && (
                                        <textarea className="w-full p-3 border rounded-lg" rows="3" placeholder="Nyatakan sebab/lokasi..." value={leaveReason} onChange={(e) => setLeaveReason(e.target.value)}></textarea>
                                    )}
                                    <button onClick={handleAttendanceSubmit} disabled={!selectedTeacherId} className={`w-full py-3 rounded-lg font-bold text-white ${selectedTeacherId ? 'bg-blue-600 hover:bg-blue-700' : 'bg-gray-300'}`}>{scanMessage ? 'Disimpan!' : 'Sahkan & Hantar'}</button>
                                    {scanMessage && <div className="p-3 bg-green-100 text-green-700 rounded-lg text-center font-bold mt-2">{scanMessage}</div>}
                                </div>
                            </div>
                        )}
                    </div>
                    
                    {/* PRINT LAYOUT */}
                    <div className={`print-only ${isPrinting ? 'block' : 'hidden'} bg-white p-8 w-full`}>
                        <div className="text-center mb-8 border-b-2 border-gray-800 pb-4">
                            <h1 className="text-4xl font-bold text-gray-900">KOD QR KEHADIRAN PASTI</h1>
                        </div>
                        <div className="grid grid-cols-2 gap-8 text-center">
                            <div className="border-4 border-blue-600 rounded-2xl p-6 flex flex-col items-center">
                                <h2 className="text-3xl font-extrabold text-blue-800 mb-2">QR MASUK</h2>
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=PASTI_CLOCK_IN" className="w-40 h-40 border-2 mb-4" />
                                <p className="text-xl font-bold">REKOD DATANG</p>
                            </div>
                            <div className="border-4 border-rose-600 rounded-2xl p-6 flex flex-col items-center">
                                <h2 className="text-3xl font-extrabold text-rose-800 mb-2">QR BALIK</h2>
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=PASTI_CLOCK_OUT" className="w-40 h-40 border-2 mb-4" />
                                <p className="text-xl font-bold">REKOD PULANG</p>
                            </div>
                             <div className="border-4 border-purple-600 rounded-2xl p-6 flex flex-col items-center">
                                <h2 className="text-3xl font-extrabold text-purple-800 mb-2">TUGAS LUAR</h2>
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=PASTI_OUTSTATION" className="w-40 h-40 border-2 mb-4" />
                                <p className="text-xl font-bold">KURSUS</p>
                            </div>
                            <div className="border-4 border-orange-600 rounded-2xl p-6 flex flex-col items-center">
                                <h2 className="text-3xl font-extrabold text-orange-800 mb-2">CUTI / MC</h2>
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=PASTI_LEAVE" className="w-40 h-40 border-2 mb-4" />
                                <p className="text-xl font-bold">TIDAK HADIR</p>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const AdminView = () => {
                if (!isAdmin) return (
                    <div className="flex flex-col items-center justify-center min-h-[50vh] p-4 no-print">
                        <div className="bg-white p-8 rounded-xl shadow-xl w-full max-w-sm text-center border-t-4 border-gray-800">
                            <i className="ph ph-lock-key text-4xl text-gray-700 mb-4"></i>
                            <h2 className="text-2xl font-bold mb-2">Akses Pentadbir</h2>
                            <input type="password" placeholder="Kata Laluan" className="w-full p-3 border rounded-lg mb-4 text-center" value={passwordInput} onChange={(e) => setPasswordInput(e.target.value)} />
                            <button onClick={handleLogin} className="w-full bg-gray-800 text-white py-3 rounded-lg font-bold">Log Masuk</button>
                            <div className="mt-4 text-xs text-gray-400">Hint: admin123</div>
                        </div>
                    </div>
                );

                return (
                    <div className="p-4 max-w-5xl mx-auto no-print">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold">Panel Pentadbir</h2>
                            <button onClick={() => { setIsAdmin(false); setAdminTab('overview'); }} className="text-red-600 font-bold text-sm border px-3 py-1 rounded hover:bg-red-50">Log Keluar</button>
                        </div>
                        <div className="flex gap-2 mb-6 border-b">
                            <button onClick={() => setAdminTab('overview')} className={`px-4 py-2 font-bold rounded-t-lg ${adminTab === 'overview' ? 'bg-white text-blue-600 border-t border-x' : 'text-gray-500'}`}>Pengurusan</button>
                            <button onClick={() => setAdminTab('analysis')} className={`px-4 py-2 font-bold rounded-t-lg ${adminTab === 'analysis' ? 'bg-white text-blue-600 border-t border-x' : 'text-gray-500'}`}>Analisa</button>
                        </div>
                        {adminTab === 'overview' && (
                            <div className="bg-white rounded-xl shadow-lg p-8">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                                    <button className="flex items-center justify-center gap-2 px-4 py-4 bg-white border-2 border-dashed border-gray-300 text-gray-600 rounded-xl hover:border-blue-500 hover:text-blue-600"><i className="ph ph-user-plus text-xl"></i> Tambah Guru</button>
                                    <button className="flex items-center justify-center gap-2 px-4 py-4 bg-white border-2 border-dashed border-gray-300 text-gray-600 rounded-xl hover:border-green-500 hover:text-green-600"><i className="ph ph-file-csv text-xl"></i> Eksport Excel</button>
                                </div>
                                <div className="border-t pt-6 bg-red-50 p-4 rounded-lg flex justify-between items-center">
                                    <span className="text-red-700 font-bold">Reset Harian</span>
                                    <button onClick={() => { if(confirm("Reset semua data?")) setTeachers(initialTeachers.map(t => ({...t, status: 'Tidak Hadir', timeIn: '--:--', timeOut: '--:--', reason: ''}))); }} className="px-4 py-2 bg-white border border-red-200 text-red-600 rounded font-bold">Reset Sekarang</button>
                                </div>
                            </div>
                        )}
                        {adminTab === 'analysis' && (
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-lg p-6 h-80">
                                    <h3 className="font-bold mb-4">Analisa Tahunan</h3>
                                    {isRechartsLoaded ? (
                                        <ResponsiveContainer width="100%" height="100%">
                                            <BarChart data={mockYearlyData}><XAxis dataKey="name" /><Tooltip /><Legend /><Bar dataKey="hadir" fill="#22c55e" /><Bar dataKey="cuti" fill="#eab308" /><Bar dataKey="tidakHadir" fill="#ef4444" /></BarChart>
                                        </ResponsiveContainer>
                                    ) : (
                                        <div className="flex h-full items-center justify-center text-gray-500">Graf tidak dapat dipaparkan</div>
                                    )}
                                </div>
                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h3 className="font-bold mb-4">Prestasi Bulanan</h3>
                                    <table className="w-full text-sm text-left">
                                        <thead className="text-xs uppercase bg-gray-50"><tr><th className="px-6 py-3">Nama</th><th className="px-6 py-3">Kehadiran</th><th className="px-6 py-3">Gred</th></tr></thead>
                                        <tbody>{mockMonthlyPerformance.map((m, i) => <tr key={i} className="border-b"><td className="px-6 py-4">{m.name}</td><td className="px-6 py-4">{m.peratus}%</td><td className="px-6 py-4 font-bold">{m.grade}</td></tr>)}</tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            return (
                <div className="min-h-screen">
                    <Header />
                    <div className="container mx-auto pb-10 pt-4">
                        {view === 'dashboard' && <DashboardView />}
                        {view === 'scan' && <ScanView />}
                        {view === 'admin' && <AdminView />}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>